var l=Object.defineProperty;var d=(r,e,t)=>e in r?l(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var i=(r,e,t)=>(d(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();class c{constructor(){i(this,"audioContext",new window.AudioContext);i(this,"oscillator",null)}play(e,t){this.oscillator&&this.oscillator.stop(),this.oscillator=this.audioContext.createOscillator(),this.oscillator.type="sine",this.oscillator.frequency.setValueAtTime(e,this.audioContext.currentTime);const o=this.audioContext.createGain();this.oscillator.connect(o),o.connect(this.audioContext.destination),this.oscillator.start(),this.oscillator.stop(this.audioContext.currentTime+t)}}class h{constructor(){i(this,"svg");i(this,"gameStartTime",0);i(this,"keys",{});i(this,"playernow","tl");i(this,"isUpdatePaused",!1);i(this,"focus",!0);i(this,"frameCount",0);i(this,"sound",new c);i(this,"addeggTimeout",0);i(this,"lasteggdir","tl");i(this,"eggs",[]);i(this,"toggleElement",(e,t)=>{const o=this.svg.querySelector(e);o&&(t?o.classList.add("show"):o.classList.remove("show"))});i(this,"toggleElements",(e,t)=>{const o=this.svg.querySelectorAll(e);o.forEach(s=>{o&&(t?s.classList.add("show"):s.classList.remove("show"))})})}init(){window.addEventListener("keydown",e=>{this.keys[e.code]=!0}),window.addEventListener("keyup",e=>{this.keys[e.code]=!1})}update(){if(this.frameCount++,this.addeggTimeout<Date.now()){const e=["tl","tr","bl","br"];let t=Math.floor(Math.random()*e.length);for(;e[t]==this.lasteggdir&&this.addeggTimeout>Date.now()-2e3;)t=Math.floor(Math.random()*e.length);this.eggs.push({dir:e[t],state:0,time:Date.now()}),this.lasteggdir=e[t],this.addeggTimeout=Date.now()+(500+Math.random()*4e3)}this.keys.Space!=null&&this.toggleElement("#circle1",this.keys.Space),this.eggs.forEach((e,t)=>{e.time<Date.now()&&(e.state++,e.time=Date.now()+1e3,this.sound.play(300,.2)),e.state>4&&(e.dir==this.playernow?(this.addpoint(),this.eggs.splice(t,1)):(this.eggs.splice(t,1),this.broken(e.dir[1]))),this.toggleElement(`#egg-${e.dir}-${e.state}`,!0),this.toggleElement(`#egg-${e.dir}-${e.state-1}`,!1)}),this.toggleElements("#player *",!1),this.toggleElement(`#player-${this.playernow}`,!0)}broken(e){this.toggleElement(`#egg-broken-${e}`,!0),setTimeout(()=>{this.toggleElement(`#egg-broken-${e}`,!1)},1e3),this.isUpdatePaused=!0,window.setTimeout(()=>{console.log("rest"),this.isUpdatePaused=!1},2e3),this.addeggTimeout=this.addeggTimeout+2e3,this.sound.play(400,.2)}addpoint(){console.log("Point!"),this.addeggTimeout=this.addeggTimeout+1e3,this.sound.play(800,.2),this.isUpdatePaused=!0,window.setTimeout(()=>{console.log("rest point"),this.isUpdatePaused=!1},1e3)}slowUpdate(){}input(){var e;this.keys.KeyW?this.playernow="tl":this.keys.KeyS?this.playernow="bl":this.keys.KeyO?this.playernow="tr":this.keys.KeyK&&(this.playernow="br"),this.keys.Escape&&((e=document.getElementById("unfocus"))==null||e.focus()),console.log(this.keys)}gameLoop(){this.focus&&(this.isUpdatePaused||this.update(),this.input()),requestAnimationFrame(()=>this.gameLoop())}start(){this.init(),this.gameStartTime=Date.now(),console.log(this.gameStartTime),this.gameLoop()}}fetch("./lcd.svg").then(r=>r.text()).then(r=>{var a;const o=new DOMParser().parseFromString(r,"image/svg+xml").querySelector("svg");(a=document.getElementById("game"))==null||a.appendChild(o);const s=new h;s.svg=o,setTimeout(()=>{s.start()},2e3)}).catch(r=>console.error("Error loading SVG:",r));
